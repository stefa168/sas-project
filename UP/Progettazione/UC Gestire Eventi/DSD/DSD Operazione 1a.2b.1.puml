@startuml
skinparam Style strictuml

collections UI
participant "evenManager: EventManager" as em
participant "userMgr: UserManager" as um
participant "event: Event" as ev
participant "service.serviceJobs: ArrayList<serviceJob>" as sj
participant "task.jobs: ArrayList<kitchenJob>" as kj
participant "sheet.tasks : ArrayList <Task>" as shta
participant "event.services : ArrayList <Service>" as evse
participant "event.macroEvent: MacroEvent" as maev
participant "macroEvent.events: ArrayList <Event>" as events
participant "eventManager.eventReceivers: EventEventReceivers" as eer


UI -> em: deleteEvent(event)
activate em
em -> um: getCurrentUser()
activate um
em <<-- um: user
deactivate um

alt !user.isOrganizer() || event.getMacroEvent().getOrganizer() != user
    UI <<-- em: throw UseCaseLogicException
else
    em -> ev: delete()
    activate ev

    loop for all service in event.services
        loop for all serviceJob in service.serviceJobs
            ev -> sj: delete (serviceJob)
            activate sj
            deactivate sj
        end
        loop for all task in service.sheet.tasks
            loop for all kitchenJob in task.jobs
                ev -> kj: delete(kitchenJob)
                activate kj
                deactivate kj
            end
            |||
            ev-> shta: delete(task)
            activate shta
            deactivate shta
        end
        |||
        ev-> evse : delete (service)
        activate evse
        deactivate evse
    end
    ev -> maev: delete(this)
    activate maev
    alt event.equals(macroEvent.defaultEvent)
    maev -> maev: this.defaultEvent = null
    end
    maev -> events: delete(event)
    activate events
    deactivate events


    deactivate maev

    deactivate ev

    |||

    loop for all receivers in eventReceivers
        em -> eer: updateDeleteEvent(event)
        activate eer
        deactivate eer
    end
    |||
    deactivate em
    |||
end
@enduml