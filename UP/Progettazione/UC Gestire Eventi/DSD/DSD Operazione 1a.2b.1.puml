@startuml
skinparam Style strictuml

collections UI
participant "evenManager: EventManager" as em
participant "userMgr: UserManager" as um
participant "event: Event" as ev
participant "task.jobs: ArrayList<KitchenJob>" as kj
participant "service.serviceJobs: ArrayList<ServiceJob>" as sj
participant "service.sheet.tasks : ArrayList <Task>" as shta
participant "event.services : ArrayList <Service>" as evse
participant "event.macroEvent: MacroEvent" as maev
participant "macroEvent.events: ArrayList <Event>" as events
participant "eventManager.eventReceivers: EventEventReceivers" as eer


UI -> em: deleteEvent(event)
activate em
em -> um: getCurrentUser()
activate um
em <<-- um: user
deactivate um

alt !user.isOrganizer() || event.getMacroEvent().getOrganizer() != user
    UI <<-- em: throw UseCaseLogicException
else
    em -> ev: delete()
    activate ev

    loop for all service in event.services

        loop for all task in service.sheet.tasks
            ev -> kj: clear()
            activate kj
            deactivate kj
        end

        ev -> sj: clear ()
        activate sj
        deactivate sj

        ev-> shta: clear()
        activate shta
        deactivate shta
    end

    ev-> evse : clear ()
    activate evse
    deactivate evse

    ev -> maev: delete(this)
    activate maev
    alt event.equals(macroEvent.defaultEvent)
    maev -> maev: this.defaultEvent = null
    end
    maev -> events: remove(event)
    activate events
    deactivate events


    deactivate maev

    deactivate ev

    |||

    loop for all receivers in eventReceivers
        em -> eer: updateDeleteEvent(event)
        activate eer
        deactivate eer
    end
    |||
    deactivate em
    |||
end
@enduml